<!DOCTYPE html>
<html>
    <head>
        <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-357M2XRREY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-357M2XRREY');
</script>
        <meta charset="utf-8">
        <title>るろい</title>
        <link rel="apple-touch-icon" href="r3.png" />
        <link rel="stylesheet" href="index.css">
    </head>
    <body onload="get_data11()">

<div class="bclokk" id="blockk">
        <style>
        .all{
        display:none;
        opacity:0;
        }
        .all1{
        display:none;
        opacity:0;
        }
        .block{
        display:block;
        opacity:1;
        font-size:5vw;
        }
        </style>
        <div class="block">
            <p>ただいまメンテナンス中</p>
            </div>
</div>

<div class="blockkk" id="blockkk">
<div class="alert" id="alert">
    <div class="p" id="p">
        <h1 class="h1" id="h1">
 
        </h1>
        <p class="p2" id="p2">
 
        </p>
        <div class="c" id="c">
            閉じる
        </div>
    </div>
</div>
<div class="all" id="all" onclick="get_data()">
    <img id="imgs"src="r3.png">
    <p class="l1" id="l1d">がめんたっぷしてろーど</p>
</div>
<div class="all1" id="all1">
        <div class="top1">
            <img src="r3.png">
            <div class="top_bar">
                <div class="section1" onclick="sec1()">
                    <p>とうろく</p>
                    <img src="omu4.jpg">
                </div>
                <div class="section2" onclick="sec2()">
                    <p>じょうほうていきょう</p>
                    <img src="omu4.jpg">
                </div>
                <div class="section3" onclick="sec3()">
                    <p>ごいけん</p>
                    <img src="omu4.jpg">
                </div>

            </div>
            
         
        </div>
        <div class="body1" >
            <div class="todays">
                <h2>今日の一句</h2>
                <p id="today"></p>
            </div>
            
            <div class="newsr" >
                <img src="bell.png"id="belll" class="belll" onclick="news()">
                <div class="cont" id="cont">
                    <div id="d1" class="d1">
                    <small>NEWS</small>
                   <p class="n1" id="n1">ニュース</p>
                </div>
                <div id="d2" class="d2">
                    <div id="d3" class="d3" onclick="bt1()">
                   <p class="n2" id="n2"onclick="bt1()">ルロイ氏飲酒か</p>
                   <small onclick="bt1()">先日、内部告発により明らかになった事実、真相はいかに</small>
                </div>
                <div id="d3" class="d3" onclick="bt2()">
                   <p class="n2" id="n2">ルロイ氏下腹部露出か</p>
                   <small>昨年、国外において自らの下腹部を、いったいなぜ</small>
                   </div>
                   <div id="d3" class="d3" onclick="bt3()">
                   <p class="n2" id="n2">ルロイ氏グーンのSBが好みか</p>
                   <small>ルロイ氏のツイートより明らかになった衝撃の事実、それはいったい</small>
                </div>
                <div id="d3" class="d3" onclick="bt4()">
                    <p class="n2" id="n2">おめでとう</p>
                    <small>みずむらあめでとう</small>
                 </div>
                </div>
                </div>
                
            </div>
            <div id="bar" class="bar">
                <p class="swip" id="swip">スワイプして閉じる</p>
                <div class="sw_block">
                <p class="swipe" id="swip2">＞</p>
                <p class="swipe" id="swip3">＞</p>
                <p class="swipe" id="swip4">＞</p>
            </div>
            </div>
            <h3>ろいじてん</h3>
            <div class="dic" onclick="om2()">
                
                <img src="om3.png">
            </div>
            <h3>るろいしゃしんかん</h3>
            <div class="outl">
            <div class="pic" onclick="om3()"> 
                
                <img src="om2.jpg">
                
            </div>
            <a href="picl.html">軽量版はこちら</a>
        </div>
        </div>
        <div class="news">
            <h3><span>お</span><span>し</span><span>せ</span><span>ら</span><span>せ</span></h3>
            <div class="list">
                <div class="cl"></div>
                <div class="texts">
                <h4>まいにちるろい機能サービス開始<span>2023 3/12</span></h4>
                <p>メインページの上部にまいにちるろい機能の登録ページへのボタンを作りました。メールアドレスを登録すると毎日るろいからポエムが送られてくるよ</p>
            </div>
                
            </div>
            <div class="list">
                <div class="cl"></div>
                <div class="texts">
                <h4>るろいニュースサービス開始<span>2024 4/14</span></h4>
                <p>マインページ右上にベルマークが追加されました。このベルマークが振動しているときは新着のニュースがあります。ぜひクリックしてみてね</p>
                </div>
            </div>
            <div class="list">
                <div class="cl"></div>
                <div class="texts">
                <h4>じょうほうていきょうサービス開始<span>2024 4/21</span></h4>
                <p>メインページ上部のじょうほうていきょうボタンをクリックしてページへアクセスしよう</p>
                </div>
            </div>
             
        </div>
        
        <h3 class="qrh">きょうゆうできるよ</h3>
        <img class="qr"src="qr.png">
        
    </div>
</div>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script>
            num = 0;
            music = '';
            datas = '';
            todyas = '';
document.getElementById("bar").addEventListener('touchmove',logswipe);
document.getElementById("bar").addEventListener('touchstart',logswipestart);
document.getElementById("bar").addEventListener('touchend',logswipeend);
function get_data11(){
    var url ="https://script.google.com/macros/s/AKfycbwQz_gCyGLVv6qBxPo8Zzti56XeqIvxLIMnO_lESWz1adJL24u5uSRWve3G9AAopkE/exec";
    fetch(url,{
        "method":"get",
        "mode":"cors",
    })
    .then(response =>{
       if(response.ok){
        return response.json();
       }
    })
    .then(resjson =>{
        var data = resjson[0];
        if(data == "run"){
            document.getElementById("blockk").style.display = " none";
            document.getElementById("blockk").style.opacity = " 0";
            document.getElementById("blockkk").style.display = " block";
            document.getElementById("blockkk").style.opacity = " 1";
            get_data1();
        }else{
            document.getElementById("blockk").style.display = " block";
            document.getElementById("blockk").style.opacity = " 1";
            document.getElementById("blockkk").style.display = " none";
            document.getElementById("blockkk").style.opacity = " 0";
        }
    })
}
            function logswipestart(event){
  event.preventDefault();
  startx = event.touches[0].pageX;
}
function logswipe(event){
event.preventDefault();
endx = event.touches[0].pageX;
}
function logswipeend(event){
event.preventDefault();
if(0 < endx-startx){
  scroll_out();
}else{
  console.log("opsite")
}
}
function data_send(){
    console.log("Ip Address Getting");
    fetch('https://ipinfo.io?callback')
    .then(res => res.json())
    .then(json => next(json.ip))
}
function next(ipaddress){
 var url = "https://script.google.com/macros/s/AKfycbwQz_gCyGLVv6qBxPo8Zzti56XeqIvxLIMnO_lESWz1adJL24u5uSRWve3G9AAopkE/exec";
 var data = [{
    "branch":"access",
    "ip":ipaddress
 }]
 var params = {
    "method":"post",
    "mode":"no-cors",
    "Content-Type":"application/json",
    "body":JSON.stringify(data)
 }
 console.log(params);
 fetch(url,params);
}
function get_data1(){
    data_send();
    data = document.cookie;
    console.log(data);
    var c1 = data.indexOf("status=");
    if(c1 !=-1){
        var c2 = data.indexOf("todaysp=");
        if(c2 !=-1){
            var c3 = data.indexOf("¥",c2);
            c2 = parseInt(c2)+8;
            console.log("c2:"+c2);
            var tp = data.substring(c2,c3);
            tp = decodeURI(tp);
             console.log("tp:"+tp);
            document.getElementById("today").innerHTML = tp;
            console.log("Skip Success")
        }else{
            console.log("cookie<todays>Error");
                var res = confirm('CookieError');
                if(res){
                  location.href="index.html"
                  }
        }
        
      stop();
      get_data();
    }else{
        console.log("Cookie<None Datas>")
            get_data();
    }
}
            function get_data(){
                ani();
                start();
                console.log("Loading START");
                url = "https://script.google.com/macros/s/AKfycbxBpYYGDKoT_seVEvk7N8BSiWAWQg-XXHwugJrpx7O83z_apYkN5tKw6cWJBCsw85c/exec";
                fetch(url,{
        "method":"GET",
        "mode":"cors"
    })
    .then(response => {
     if(response.ok){
        return response.json();
     }
    })
    .then(resJson =>{
        console.log("Load Succeed");
        todays = resJson;
        datas = "ruroi_data="+JSON.stringify(resJson)+"->";
        console.log(datas);
      document.cookie = datas;
      document.cookie = "status=ok*; Max-Age=120"
      console.log("Cookie Wrote Status");
      get_data2();
    })
            }
            todays_p = "";
            function get_data2(){
                console.log("Getting Number");
                fetch('https://script.google.com/macros/s/AKfycbycg9aGaM3EEYKALXnKDtEPbvb9wPJ5ngBRPXjQ73AFPKAWypjSFz_br3Gs933qSJ8/exec',{
                    "method":"get",
                    "mode":"cors"
                })
                .then(response =>{
                    if(response.ok){
                        return response.json()
                    }
                })
                .then(resJson =>{
                    console.log("Got Number");
                    number = resJson[0];
                    todays_p = todays[number];
                    todays_p = encodeURI(todays_p);
                    todays_pc = "todaysp="+todays_p+"¥; max-age=120";
                    document.cookie = todays_pc;
                  document.getElementById("today").innerHTML = todays[number];
                  console.log(todays_pc);
                  //ニュースあれば
                  check_alert();
                  bell();
                  stop();
                })
                .catch(error =>{
                alert("Error");
                console.log(error);
                })
            }
            function start(){
                console.log("start");
                num++;
                if(num == 1){
                      document.getElementById("l1d").innerHTML = "ろーどちゅー"
                    //document.getElementById("musics").style.display="none";
                    //document.getElementById("musics").style.opacity = 0;                    
                music = new Audio('chinp.mp3')
                music.load();
                music.play();
                music.volume = 1.0;
                }else{

                }
            }
            function om3(){
                location.href="pic.html"
            }
            function om2(){
                location.href="dic.html"
            }
            function search(){
                data = document.getElementById("text").value;
                if(data == "マン凸ホームラン"){
                    music.pause();
                    document.getElementById("text").value = "";
                }
            }
            time = '';
            function ani(){
                time = setInterval(()=>{
                    $("#imgs").animate({
                    'opacity':0
                },1000)
                $("#imgs").animate({
                    'opacity':1
                },1000)
                },2000)
            }
            function stop(){
             clearInterval(time);
             document.getElementById("all").style.display = "none";
             document.getElementById("all").style.opacity = 0;
             document.getElementById("all1").style.display = "block";
             document.getElementById("all1").style.opacity = 1;
            }
            function sec1(){
                location.href = "regi.html";
            }
            function sec2(){
                location.href = "info.html";
            }
            function sec3(){
                location.href = "re.html";
            }
            count = 0;
            master_count = 0;
            function bell(){
                master_count++;
                if(master_count > 50){
                  return
                }
                count = 0;
                var branch = setInterval(()=>{
                    if(count==5){
                        clearInterval(branch);
                        bell2();
                        return;
                    }else{
                    $("#belll").css("transform","rotate("+count+"deg)")
                    count++;
                    }
                },5)
            }
            function bell2(){
                var branch = setInterval(()=>{
                    if(count==-5){
                        clearInterval(branch);
                        bell();
                        return;
                    }else if(count > 0){
                    $("#belll").css("transform","rotate("+count+"deg)")
                    count--;
                    }else if(count == 0){
                        $("#belll").css("transform","scale(-1,1)")
                        count--;
                    }else if(count < 0 ){
                        $("#belll").css("transform","rotate("+count+"deg)")
                        count--;
                    }
                },5)
            }
            function news(){
                //location.href = "top_news.html";
                console.log('start')
                $("#cont").animate({
                    "right":'0',
                    "width":0,
                    "opacity":0
                },{
                    duration:0,
                    easing:"linear"
                })
                $("#cont").animate({
                    "right":'0',
                    "width":'100vw',
                    "opacity":1
                },{
                    duration:500,
                    easing:"linear"
                })
                $("#swip").animate({
                    "opacity":0
                },0)
                $("#swip").animate({
                    "opacity":1
                },{
                    duration:1000,
                    easing:"linear"
                })

               setTimeout(()=>{
                document.getElementById("cont").style.display ="block";
                document.getElementById("d3").style.display ="block";
                document.getElementById("d2").style.display ="block";
                document.getElementById("d1").style.display ="block";
                document.getElementById("bar").style.display ="block";
                document.getElementById("swip").style.display ="block";
                document.getElementById("swip2").style.display ="block";
                document.getElementById("swip3").style.display ="block";
                document.getElementById("swip4").style.display ="block";
                setTimeout(()=>{
                    swip_ani();
                },2000);
               },0)
            }
            function swip_ani(){
                $("#swip2").animate({
                'left':0,
                'opacity':0
             },0)
             $("#swip3").animate({
                'left':0,
                'opacity':0
             },0)
             $("#swip4").animate({
                'left':0,
                'opacity':0
             },0)
             $("#swip").animate({
                'opacity':0
             },1000)
             $("#swip2").animate({
                'opacity':1
             },1000)
             $("#swip2").animate({
                'left':'90vw',
                'opacity':0
             },1500)
             $("#swip3").animate({
                'opacity':1
             },1200)
             $("#swip3").animate({
                'left':'90vw',
                'opacity':0
             },1700)
             $("#swip4").animate({
                'opacity':1
             },1400)
             $("#swip4").animate({
                'left':'90vw',
                'opacity':0
             },1900)
             
            }
            function scroll_out(){
                $("#cont").animate({
                    
                    "width":0,
                    "opacity":0
                },{
                    duration:500,
                    easing:"linear"
                })
               setTimeout(()=>{
                document.getElementById("cont").style.display ="none";
                document.getElementById("bar").style.display ="none";
               },500)
            }
            function bt1(){
                
                location.href="news1.html";
            }
            function bt2(){
                location.href="news2.html";
            }
            function bt3(){
                location.href="news3.html";
            }
            function bt4(){
                //var text = confirm("記念日を入力(例：1月1日)");
                var text = prompt("記念日を入力(例：1月1日)");
                if(text == "6月17日"){
                    location.href="./mizumura/index.html";
                }else{
                    alert("間違っています");
                }
            }
            function check_alert(){
var url = "https://script.google.com/macros/s/AKfycbwx2_Sttue96jHbLrcBxHHXqQ0pqDHtclNMYEmFITycbjDlcRxAHim3X6Q-UhXEWrA/exec";
fetch(url,{
    "method":"GET",
    "mode":'cors',
})
.then(response =>{
    if(response.ok){
        return response.json()
    }
})
.then(json =>{
    console.log(json);
    var theme = json[0];
    var contents = json[1];
    console.log(theme+","+contents)
    if(theme.length == 0 && contents.length == 0){
        return;
    }else{
        document.getElementById("alert").style.display = "block";
        document.getElementById("alert").style.opacity = "1";
        document.getElementById("all1").style.display = "none";
        document.getElementById("all1").style.opacity = "0"
        document.getElementById("h1").innerHTML = theme;
        document.getElementById("p2").innerHTML = contents;

    }

})
.catch(error =>{
    alert(error);
})
            }
document.getElementById("c").addEventListener("click",()=>{
    document.getElementById("alert").style.display = "none";
    document.getElementById("alert").style.opacity = "0";
            document.getElementById("all1").style.display = "block";
        document.getElementById("all1").style.opacity = "1"
})
        </script>
    </body>
</html>